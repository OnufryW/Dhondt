# Create input tables for indices.cfg.
INPUT TABLES v15, v19, v23, seats;
TRANSFORM seats TO s15 WITH id AS id, a AS seats;
TRANSFORM seats TO s19 WITH id AS id, b AS seats;
TRANSFORM seats TO s23 WITH id AS id, c AS seats;

# Produce the index tables.
RUN FILE "../vote_strength_inequality/indices.cfg" FROM v15, s15 INTO r15;
TRANSFORM r15 TO lhi15 WITH 2015 AS year, lhi AS ind;
TRANSFORM r15 TO ghi15 WITH 2015 AS year, ghi AS ind;

RUN FILE "../vote_strength_inequality/indices.cfg" FROM v19, s19 INTO r19;
TRANSFORM r19 TO lhi19 WITH 2019 AS year, lhi AS ind;
TRANSFORM r19 TO ghi19 WITH 2019 AS year, ghi AS ind;

RUN FILE "../vote_strength_inequality/indices.cfg" FROM v23, s23 INTO r23;
TRANSFORM r23 TO lhi23 WITH 2023 AS year, lhi AS ind;
TRANSFORM r23 TO ghi23 WITH 2023 AS year, ghi AS ind;

# Union everything together.
UNION lhi15, lhi19, lhi23 TO lhi;
UNION ghi15, ghi19, ghi23 TO ghi;

OUTPUT TABLES lhi, ghi;
