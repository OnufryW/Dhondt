# See REAMDE.md for usage.
# This is the data about Sejm election results in 2023, grouped by community,
# the format is standard for by-community Sejm election results, see the
# README.md file.
# Foreign votes are grouped by country of origin, which is placed in the
# 'community' column, the TERYT is an artificial 149901.

LOAD raw FROM 'raw/wyniki_gl_na_kand_po_gminach_utf8.csv'; 
TRANSFORM raw TO sanitized WITH 
  if(and(len($?) > 0, beginning($?, 1) = '"'), beginning(end($?, 1), -1), $?) FOR 1:7,
  if(or($? = '', $? = '""'), 0, int($?)) FOR 7:
;
TRANSFORM sanitized TO table WITH
  # Foreign commissions have an empty teryt, fake 149901
  $1 AS okw,
  $2 AS teryt,
  $3 AS community_type,
  $4 AS community,
  $5 AS county,
  $6 AS voivodship, 
  
  $30 AS number_of_commissions,
  $30 AS number_of_considered_commissions,
  $7 AS cards_received,
  $8 AS eligible_voters,
  $9 AS unused_cards,
  $10 AS voters_who_received_cards_in_person,
  $11 AS voters_voting_throuhg_intermediary,
  $12 AS voters_voting_through_right_to_vote,
  $14 AS by_mail_packets_received,
  $15 AS by_mail_packets_without_declaration,
  $16 AS by_mail_packets_with_unsigned_declaration,
  $17 AS by_mail_packets_without_envelope,
  $18 AS by_mail_packets_with_unsealed_envelope,
  $19 AS by_mail_packets_in_urn,
  $20 AS cards_retrieved_from_urn,
  $21 AS cards_out_of_envelopes,
  $22 AS invalid_cards,
  $23 AS valid_cards,
  $24 AS invalid_votes,
  $25 AS invalid_too_many_xs,
  $26 AS invalid_no_x,
  $27 AS invalid_struck_list,
  $28 AS Duda,
  $29 AS Trzaskowski;
  
