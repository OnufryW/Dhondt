INPUT TABLES table;

TRANSFORM table WITH
  assert(at(1) = teryt) AS position_1,
  assert(at(2) = community) AS position_2,
  assert(at(3) = county) AS position_3,
  assert(at(4) = voivodship) AS position_4,
  assert(int(at(5)) = number_of_commissions) AS position_5,
  assert(int(at(6)) = number_of_considered_commissions) AS position_6,
  assert(int(at(7)) = cards_received) AS position_7,
  assert(int(at(8)) = eligible_voters) AS position_8,
  assert(int(at(9)) = unused_cards) AS position_9,
  assert(int(at(10)) = voters_who_received_cards_in_person) AS position_10,
  assert(int(at(11)) = by_mail_packets_sent) AS position_11,
  assert(int(at(12)) = voters_who_received_cards_in_total) AS position_12,
  assert(int(at(13)) = voters_voting_through_intermediary) AS position_13,
  assert(int(at(14)) = voters_voting_through_right_to_vote) AS position_14,
  assert(int(at(15)) = by_mail_packets_received) AS position_15,
  assert(int(at(16)) = by_mail_packets_without_declaration) AS position_16,
  assert(int(at(17)) = by_mail_packets_with_unsigned_declaration) AS position_17,
  assert(int(at(18)) = by_mail_packets_without_envelope) AS position_18,
  assert(int(at(19)) = by_mail_packets_with_unsealed_envelope) AS position_19,
  assert(int(at(20)) = by_mail_packets_in_urn) AS position_20,
  assert(int(at(21)) = cards_retrieved_from_urn) AS position_21,
  assert(int(at(22)) = cards_out_of_envelopes) AS position_22,
  assert(int(at(23)) = invalid_cards) AS position_23,
  assert(int(at(24)) = valid_cards) AS position_24,
  assert(int(at(25)) = invalid_votes) AS position_25,
  assert(int(at(26)) = invalid_too_many_xs) AS position_26,
  assert(int(at(27)) = invalid_no_x) AS position_27,
  assert(int(at(28)) = invalid_struck_list) AS position_28,
  assert(int(at(29)) = valid_votes_total) AS position_29,
  assert(at(5) = at(6)) AS all_commissions_valid,
  # at(7) = at(9) + at(10) AS optional_all_cards_accounted,
  assert(at(12) = at(10) + at(11)) AS voters_who_got_cards,
  assert(not(at(15) > at(11))) AS received_no_more_than_sent,
  # at(15) = at(16) + at(17) + at(18) + at(19) + at(20) AS optional_all_mail_packets_counted,
  # at(20) = at(22) AS optional_what_you_put_in_is_what_you_get_out,
  assert(at(21) = at(23) + at(24)) AS cards,
  assert(at(24) = at(25) + at(29)) AS votes,
  # at(25) = at(26) + at(27) + at(28) AS optional_invalid_votes,
  assert(at(29) = sum_range(30:)) AS total_votes
;
