# See README.md for usage.
# This is data about the Sejm election results in 2015, grouped by community,
# the format is standard for by-community election results, see the
# README.md file.
# Foreign votese are grouped together into one row with the community set
# to 'Zagranica'.
# County and voivodship names are missing.

LOAD raw FROM 'raw/2015_by_community.csv';
TRANSFORM raw TO table WITH
  $? FOR 1:4,
  if(or($? = '', $? = '-'), 0, int(replace($?, ',', ''))) FOR 4:
;
TRANSFORM table WITH
  $2 AS teryt,
  $3 AS community,
  "" AS county,
  "" AS voivodship,
  $4 AS number_of_commissions,
  $4 AS number_of_considered_commissions,
  $6 AS cards_received,
  $5 AS eligible_voters,
  $7 AS unused_cards,
  $8 AS voters_who_received_cards_in_person,
  $11 AS by_mail_packets_sent,
  $8 + $11 AS voters_who_received_cards_in_total,
  $9 AS voters_voting_through_intermediary,
  $10 AS voters_voting_through_right_to_vote,
  $12 AS by_mail_packets_received,
  $13 AS by_mail_packets_without_declaration,
  $14 AS by_mail_packets_with_unsigned_declaration,
  $15 AS by_mail_packets_without_envelope,
  $16 AS by_mail_packets_with_unsealed_envelope,
  $17 AS by_mail_packets_in_urn,
  $18 AS cards_retrieved_from_urn,
  $19 AS cards_out_of_envelopes,
  $20 AS invalid_cards,
  $21 AS valid_cards,
  $22 AS invalid_votes,
  $23 AS invalid_too_many_xs,
  $24 AS invalid_no_x,
  $25 AS invalid_struck_list,
  $26 AS valid_votes_total,
  # Actual results
  $27 AS PrawoISprawiedliwość,
  $28 AS PlatformaObywatelska,
  $29 AS Razem,
  $30 AS Korwin,
  $31 AS PolskieStronnictwoLudowe,
  $32 AS ZjednoczonaLewica,
  $33 AS Kukiz15,
  $34 AS Nowoczesna,
  $35 AS Bezpartyjni,
  $36 AS Stonoga,
  $37 AS RzeczpospolitaPolska,
  $38 AS ZjednoczeniDlaŚląska,
  $39 AS Samoobrona,
  $40 AS SzczęśćBoże,
  $41 AS KongresNowejPrawicy,
  $42 AS MniejszośćNiemiecka,
  $43 AS ObywateleDoParlamentu
;


