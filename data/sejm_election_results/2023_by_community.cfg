# See REAMDE.md for usage.
# This is the data about Sejm election results in 2023, grouped by community,
# the format is standard for by-community Sejm election results, see the
# README.md file.
# Foreign votes are grouped by country of origin, which is placed in the
# 'community' column, the TERYT is an artificial 149901.

LOAD raw FROM 'raw/2023_by_community.csv';
TRANSFORM raw TO sanitized WITH 
  $? FOR 1:5,
  if($? = '', 0, int($?)) FOR 5:
;
TRANSFORM sanitized TO table WITH
  # Foreign commissions have an empty teryt, fake 149901
  if($1 = '', '149901', $1) AS teryt,
  $2 AS community,
  $3 AS county,
  $4 AS voivodship, 
  # Skipping district ID.
  $6 AS number_of_commissions,
  $7 AS number_of_considered_commissions,
  $8 AS cards_received,
  $9 AS eligible_voters,
  $10 AS unused_cards,
  $11 AS voters_who_received_cards_in_person,
  $12 AS by_mail_packets_sent,
  $13 AS voters_who_received_cards_in_total,
  $14 AS voters_voting_through_intermediary,
  $15 AS voters_voting_through_right_to_vote,
  $16 AS by_mail_packets_received,
  $17 AS by_mail_packets_without_declaration,
  $18 AS by_mail_packets_with_unsigned_declaration,
  $19 AS by_mail_packets_without_envelope,
  $20 AS by_mail_packets_with_unsealed_envelope,
  $21 AS by_mail_packets_in_urn,
  $22 AS cards_retrieved_from_urn,
  $23 AS cards_out_of_envelopes,
  $24 AS invalid_cards,
  $25 AS valid_cards,
  $26 AS invalid_votes,
  $27 AS invalid_too_many_xs,
  $28 AS invalid_no_x,
  $29 AS invalid_struck_list,
  $30 AS valid_votes_total,
  $? FOR 31:
;
  
