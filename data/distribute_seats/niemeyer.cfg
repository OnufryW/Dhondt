# Distribute seats using the least-remainder method.
INPUT TABLES parameter;
TRANSFORM parameter WITH "D" + district AS vid, sum_range(2:) AS val;
PIVOT parameter WITH NEW_HEADERS_FROM vid;

# Debug data
#TRANSFORM parameter TO dumpable WITH (460 * curr()) / sum_range(1:) FOR 1: AS currname();
#PIVOT dumpable WITH OLD_HEADERS_TO district;
#TRANSFORM dumpable WITH substr(district, 1, 1000) AS id, at(2) AS ideal_seats;
#DUMP dumpable;

TRANSFORM parameter WITH niemeyer(int(460), index(currname()), 1:) FOR 1:;
PIVOT parameter WITH OLD_HEADERS_TO district;
TRANSFORM parameter TO seats WITH substr(district, 1, 1000) AS id, at(2) AS seats;
OUTPUT TABLES seats;
