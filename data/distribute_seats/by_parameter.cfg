# Params:
# method: right now, has to be the string "dhondt". This is future-proofing,
#         if I implement other seat-assignment aggregations like Saint-Lague,
#         or smallest-remainder.

INPUT TABLES parameter;
TRANSFORM parameter WITH "D" + district AS vid, sum_range(2:) AS val;
PIVOT parameter WITH NEW_HEADERS_FROM vid;
TRANSFORM parameter WITH dhondt(int(460), index(currname()), 1:) FOR 1:;
PIVOT parameter WITH OLD_HEADERS_TO district;
TRANSFORM parameter TO seats WITH substr(district, 1, 1000) AS id, at(2) AS seats;
OUTPUT TABLES seats;
